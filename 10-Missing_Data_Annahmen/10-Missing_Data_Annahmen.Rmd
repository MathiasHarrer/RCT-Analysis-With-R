---
title: Evaluation Randomisiert-Kontrollierter Studien und Experimente mit \textsf{R}
subtitle: Missing Data
author: Prof. Dr. David Ebert & Mathias Harrer
date: Graduiertenseminar TUM-FGZ
institute: Psychology & Digital Mental Health Care, Technische Universität München
output: binb::metropolis
fontsize: 11pt
bibliography: bib.bib
csl: apa.csl
monofont: "Fira Code"
mainfont: "Fira Sans"
header-includes: |
  ```{=latex}
  \makeatletter
  \let\@@magyar@captionfix\relax
  \makeatother
  \usepackage{xcolor}
  \definecolor{protectBlue}{RGB}{48,124,148}
  \definecolor{protectGreen}{RGB}{161, 198, 66}
  \definecolor{verywhite}{rgb}{1, 1, 1}
  \usepackage{multicol}
  \hypersetup{colorlinks,citecolor=protectGreen,
    filecolor=red,linkcolor=protectGreen,urlcolor=blue}
  \setbeamercolor{progress bar}{fg=protectGreen}
  \setbeamercolor{alerted text}{fg=protectGreen}
  \setbeamercolor{frametitle}{bg=protectBlue}
  \setbeamercolor{normal text}{fg=protectBlue}
  \titlegraphic{%
  \hspace*{6cm}~%
  \includegraphics[width=2cm]{logo/tum-lightblue}
  \hspace*{0.3cm}~%
  \includegraphics[width=2cm]{logo/protect}}
  \setbeamertemplate{frame footer}{Evaluation Randomisiert-Kontrollierter Studien und Experimente mit \textsf{R}}%         <- !!SET FOOTER TITLE!!
  \makeatletter
  \setlength{\metropolis@frametitle@padding}{2.2ex}
  \setbeamertemplate{footline}{%
      \begin{beamercolorbox}[wd=\textwidth, sep=0.7ex]{footline}
          \usebeamerfont{page number in head/foot}%
          \usebeamertemplate*{frame footer}
          \hfill%
          \usebeamertemplate*{frame numbering}
      \end{beamercolorbox}%
  }
  \setbeamertemplate{frametitle}{%
    \nointerlineskip%
    \begin{beamercolorbox}[%
        wd=\paperwidth,%
        sep=0pt,%
        leftskip=\metropolis@frametitle@padding,%
        rightskip=\metropolis@frametitle@padding,%
      ]{frametitle}%
    \metropolis@frametitlestrut@start%
    \insertframetitle%
    \nolinebreak%
    \metropolis@frametitlestrut@end%
    \hfill
    \includegraphics[height=2ex,keepaspectratio]{logo/tum_white}
    \end{beamercolorbox}%
  }
  \newlength{\cslhangindent}
  \setlength{\cslhangindent}{1.5em}
  \newenvironment{CSLReferences}[3]%
  {\setlength{\parindent}{0pt}%
  \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces}%
  ```
---

```{r,setup, include=FALSE}
knitr::opts_chunk$set(cache=TRUE, comment = "#>", background = '#F7F7F7')
```


# Missing Data-Mechanismen

## Unbequeme Wahrheiten ... (I)

_"Obviously the best way to treat missing data is not to have them."_
\newline \scriptsize @orchard1972missing \par \normalsize

$$~$$

Fehlende Werte sind aber, insbesondere in der medizinischen und psychologischen Forschung, 
häufig \alert{unvermeidbar}!

## Unbequeme Wahrheiten ... (II)

\metroset{block=fill} 
\begin{alertblock}{Taxonomie: Gründe für fehlende Werte in klinischen Studien}
\begin{itemize}
  \item \textbf{Instrumente}: Response Burden, zu langes Assessment, ... 
  \item \textbf{Teilnehmende}: Überforderung, Privatsphäre-Bedenken, Movationsprobleme, ...
  \item \textbf{Center}: Inadäquate Umsetzung des Studienmethodik, Personalmangel, ...
  \item \textbf{Personal}: Falsche Datenerfassung, Datenverlust, falsche Dateneingabe, ...
  \item \textbf{Studie}: Technische Fehler, Zeitverzögerungen bei Follow-Ups, ...
\end{itemize}
\end{alertblock}

\scriptsize @palmer2018systematic \par \normalsize

## Unbequeme Wahrheiten ... (III)

**Der Umgang mit fehlenden Werten in der (medizinisch-psychologischen) Forschung ist oftmals mangelhaft:** \scriptsize [@wood2004missing; @akl2015reporting; @vanbuuren, Kapitel 1.1.2] \par \normalsize

- Verteilung fehlender Werte nicht transparent berichtet
- Unpassendes missing data handling (z.B. \alert{listwise deletion})
- Adäquate Imputationsmethoden (z.B. MI, FIML) häufig nicht benutzt, inadäquat angewendet, oder
unzureichend berichtet


## Unbequeme Wahrheiten ... (IV)

**\textsf{R} macht es nicht (automatisch) "richtig"!**

\small

```{r, eval=FALSE, comment="##>", background="green"}
y <- 1:10
x <- c(1, NA, NA, NA, 3, 5, 8, 10, -1, 10)
summary(lm(y ~ x))
```

```
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept)   4.9403     1.7738   2.785   0.0387 *
## x             0.3172     0.2709   1.171   0.2945  
## ---
## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
## 
## Residual standard error: 2.904 on 5 degrees of freedom
##   (3 observations deleted due to missingness)
```
\par \normalsize

## Unbequeme Wahrheiten ... (V)

**Was dagegen tun?**

- Umsetzung von \alert{Reporting-Standards}; \scriptsize z.B. `STROBE` [@von2007strengthening] & `CONSORT` [@schulz2010consort], s.a. @sterne2009multiple. \par \normalsize
- Adäquates \alert{Missing Data Handling}
  - Basierend auf plausiblen Annahmen, warum fehlende Werte enstanden sind ("Missing Data Mechanism")
  - ggf. Schätzung (Imputation) fehlender Werte unter Einbezug von deren Unsicherheit

## MCAR, MAR & MNAR (I)

\begin{multicols}{2}

  \null \vfill
  \includegraphics[width=.3\textwidth]{rubin.jpg}
  \newline Donald B. Rubin
  \vfill \null

\columnbreak

  \null \vfill
  \textbf{Grundannahme}: Das Fehlen oder Vorhandensein von Daten ist Resultat eines probabilistischen Prozesses. \newline \newline
  Diesem Prozess versucht man sich durch ein Modell (\textbf{\emph{missing data model}}) anzunähern. 
  \vfill \null
\end{multicols}

\small [@rubin1976inference] \par \normalsize

## MCAR, MAR & MNAR (II)

\includegraphics[width=1\textwidth]{model_concept_sep.png}

[@harrer2021doing]


## MCAR, MAR & MNAR (III)

\small

Nach @rubin1976inference können Missing Data-Mechanismen in 3 Untertypen klassifiziert werden: 

\metroset{block=fill} 

\begin{exampleblock}{MCAR}
  Missing Completely At Random: rein zufällig fehlende Werte einer Variable.
\end{exampleblock}

\begin{exampleblock}{MAR}
  Missing At Random: das Fehlen von Werten einer Variable ist abhängig von anderen (observierten) Variablen $\psi$.
\end{exampleblock}

\begin{exampleblock}{MNAR}
  Missing Not At Random / "Nonignorable Missing Data": das Fehlen von Werten Variable ist (u.A.) abhängig von der Variable selbst.
\end{exampleblock}

&rightarrow; Für jede Annahme ergeben sich unterschiedliche Auswirkungen bei der Datenauswertung!

\par \normalsize

## MCAR, MAR & MNAR (IV)

\small

**Beispiele**: 

\metroset{block=fill} 

\begin{exampleblock}{MCAR}
  Missing Completely At Random: rein zufällig fehlende Werte einer Variable.
\end{exampleblock}

\begin{exampleblock}{MAR}
  Missing At Random: das Fehlen von Werten einer Variable ist abhängig von anderen (observierten) Variablen $\psi$.
\end{exampleblock}

\begin{exampleblock}{MNAR}
  Missing Not At Random / "Nonignorable Missing Data": das Fehlen von Werten Variable ist (u.A.) abhängig von der Variable selbst.
\end{exampleblock}

&rightarrow; Für jede Annahme ergeben sich unterschiedliche Auswirkungen bei der Datenauswertung!

\par \normalsize

# Second Section

## Second Frame

### Bulleted Lists
- Element A
- Element B
    - B.1
    - B.2
- Element C    

# Elements

## Typography

```
The theme provides sensible defaults to
\emph{emphasize} text, \alert{accent} parts
or show \textbf{bold} results.

In Markdown, you can also use _emphasize_ and **bold**.
```

\begin{center}becomes\end{center}

The theme provides sensible defaults to \emph{emphasize} text,
\alert{accent} parts or show \textbf{bold} results \scriptsize [@arendt1989leben; @smit2006costs; @andersson2009internet] \par.

In Markdown, you can also use _emphasize_ and **bold**.


## Math

\begin{equation*}
    e = \lim_{n\to \infty} \left(1 + \frac{1}{n}\right)^n
\end{equation*}


## R Figure Example

The following code generates the plot on the next slide (taken from
`help(bxp)` and modified slightly):

```{r pressureCode, eval=FALSE}
library(stats)
set.seed(753)
bx.p <- boxplot(split(rt(100, 4),
                      gl(5, 20)), plot=FALSE)
bxp(bx.p, notch = FALSE, boxfill = "lightblue",
    frame = FALSE, outl = TRUE,
    main = "Example from help(bxp)")
```  


## R Figure Example
  
```{r pressureFig, echo=FALSE}
library(stats)
set.seed(753)
bx.p <- boxplot(split(rt(100, 4),
                      gl(5, 20)), plot=FALSE)
bxp(bx.p, notch = FALSE, boxfill = "lightblue",
    frame = FALSE, outl = TRUE,
    main = "Example from help(bxp)")
```  

## R Table Example
  
A simple `knitr::kable` example:  

```{r kableEx}
knitr::kable(mtcars[1:5, 1:8],
             caption="(Parts of) the mtcars dataset")
```

## Using LaTeX Parts: Blocks

As one example of falling back into \LaTeX, consider the example of
three different block environments are pre-defined and may be styled
with an optional background color.

\metroset{block=fill} 

\begin{block}{Default}
  Block content.
\end{block}

\begin{alertblock}{Alert}
  Block content.
\end{alertblock}

\begin{exampleblock}{Example}
  Block content.
\end{exampleblock}



## Resources

### For more information:
- See the [Metropolis repository](https://github.com/matze/mtheme) for more on Metropolis
- See the [RMarkdown repository](https://github.com/rstudio/rmarkdown) for more on RMarkdown
- See the [binb repository](https://github.com/eddelbuettel/binb) for more on binb 
- See the [binb vignettes](https://github.com/eddelbuettel/binb/vignettes) for more examples.

## References {.allowframebreaks}

\scriptsize





